<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Nonlinear 1-D advection &mdash; Mini Computational Projects  documentation</title>
      <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="_static/graphviz.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="1-D advection in C++" href="one_d_advection_docs.html" />
    <link rel="prev" title="Linear 1-D Advection" href="lin_one_d_advection.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="index.html" class="icon icon-home"> Mini Computational Projects
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Advection</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="lin_one_d_advection.html">Linear 1-D Advection</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Nonlinear 1-D advection</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#finite-volume-discretization">Finite-volume Discretization</a></li>
<li class="toctree-l2"><a class="reference internal" href="#predictor-corrector-scheme">Predictor-Corrector Scheme:</a></li>
<li class="toctree-l2"><a class="reference internal" href="#method-of-lines">Method of Lines</a></li>
<li class="toctree-l2"><a class="reference internal" href="#slope-choices">Slope choices</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#mindmod-limiter">Mindmod Limiter</a></li>
<li class="toctree-l3"><a class="reference internal" href="#monotonized-central-difference-limiter-mc-limiter">Monotonized central difference Limiter (MC limiter)</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="one_d_advection_docs.html">1-D advection in C++</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="one_d_advection_code.html">1-D advection</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Mini Computational Projects</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
      <li>Nonlinear 1-D advection</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/nonlin_one_d_advection.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="nonlinear-1-d-advection">
<h1>Nonlinear 1-D advection<a class="headerlink" href="#nonlinear-1-d-advection" title="Permalink to this headline"></a></h1>
<section id="finite-volume-discretization">
<h2>Finite-volume Discretization<a class="headerlink" href="#finite-volume-discretization" title="Permalink to this headline"></a></h2>
<p>Rewrite advection equation in conservation form:</p>
<div class="math notranslate nohighlight">
\[a_t + \nabla[f(a)] = 0\]</div>
<p><span class="math notranslate nohighlight">\(f(a) = ua\)</span> is the flux of the quantity a. In conservation form, the time derivative of a quantity is related to the divergence of flux.</p>
<p>For finite-volume discretization:</p>
<div class="math notranslate nohighlight">
\[\frac{\partial a}{\partial t} = -\frac{\partial F(a)}{\partial x}\]</div>
<div class="math notranslate nohighlight">
\[\frac{1}{\Delta x} \int^{x_{i+1/2}}_{x_{i-1/2}} a_t dx = -\frac{1}{\Delta x}\int^{x_{i+1/2}}_{x_{i-1/2}} \frac{\partial}{\partial x} f(a) dx\]</div>
<div class="math notranslate nohighlight">
\[\frac{\partial}{\partial t} \langle a\rangle_i = -\frac{1}{\Delta x} \left\{[f(a)]_{i+1/2} - [f(a)]_{i-1/2} \right\}\]</div>
<p>We have two approaches:</p>
<ul class="simple">
<li><p>Predictor-corrector method or characteristic tracing method: Discretize <span class="math notranslate nohighlight">\(\partial a_i / \partial t\)</span> as <span class="math notranslate nohighlight">\((a_i^{n+1} -a^n_i)/\Delta t\)</span>. Then acheive second-order accuracy by evaluating the righthand of Equation above at midpoint in time <span class="math notranslate nohighlight">\((n+1/2)\)</span>.</p></li>
<li><p>Method of lines: recognize PDE becomes ODE, then use standard ODE methods like Runge-Kutta to integrate the system in time.</p></li>
</ul>
</section>
<section id="predictor-corrector-scheme">
<h2>Predictor-Corrector Scheme:<a class="headerlink" href="#predictor-corrector-scheme" title="Permalink to this headline"></a></h2>
<p>Take <span class="math notranslate nohighlight">\(\partial a_i/\partial t\)</span> as <span class="math notranslate nohighlight">\((a^{n+1}_i - a^n_i)/\Delta t\)</span> (Euler’s method). Then we have equation:</p>
<div class="math notranslate nohighlight">
\[\frac{a^{n+1}_i - a^n_i}{\Delta t} = -\frac{[f(a)]^{n+1/2}_{i+1/2} - [f(a)]^{n+1/2}_{i-1/2}}{\Delta x}\]</div>
<p>To evaluate the fluxes at half-time:</p>
<div class="math notranslate nohighlight">
\[[f(a)]^{n+1/2}_{i+1/2} = f(a^{n+1/2}_{i+1/2})\]</div>
<p>Construct a second-order accurate approximation to <span class="math notranslate nohighlight">\(a^{n+1/2}_{i+1/2}\)</span> by Taylor expanding.
Notice there are two interface states that can be constructed, either using data from left, e.g. L, or right, e.g. R.</p>
<p>Left:</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}a^{n+1/2}_{i+1/2,L} &amp;= a^n_i + \left .\frac{\Delta x}{2}\frac{\partial a}{\partial x}\right|_i + \left. \frac{\Delta t}{2} \frac{\partial a}{\partial t}\right|_i + \mathcal{O}(\Delta x^2) + \mathcal{O}(\Delta t^2)\\&amp;= a^n_i + \left. \frac{\Delta x}{2}\frac{\partial a}{\partial x} \right|_i + \left. \frac{\Delta t}{2}\left(-u\frac{\partial a}{\partial x} \right|_i\right)+...\\&amp;= a^n_i + \left. \frac{\Delta x}{2}\left(1-\frac{\Delta t}{\Delta x}u\right) \frac{\partial a}{\partial x}\right|_i + ...\end{aligned}\end{align} \]</div>
<p>Right:</p>
<div class="math notranslate nohighlight">
\[a^{n+1/2}_{i+1/2,R} = a^n_{i+1} - \left. \frac{\Delta x}{2} \left( 1 + \frac{\Delta t}{\Delta x}u\right) \frac{\partial a}{\partial x}\right|_{i+1}\]</div>
</section>
<section id="method-of-lines">
<h2>Method of Lines<a class="headerlink" href="#method-of-lines" title="Permalink to this headline"></a></h2>
<p>Treat it as ODE, and by setting <span class="math notranslate nohighlight">\(f(a) = ua\)</span>, and solve using Runge-Kutta:</p>
<div class="math notranslate nohighlight">
\[\frac{\partial a_i}{\partial t} = -\frac{ua_{i+1/2} - ua_{i-1/2}}{\Delta x} = g(a_i) = \dot{a_i}\]</div>
<p>And we have the same Riemann probalem and define:</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}a_{i+1/2,L} = a(x_i-\Delta x/2) = a_i + \frac{1}{2}\frac{\partial a_i}{\partial x} \Delta x\\a_{i+1/2,R} = a(x_i + \Delta x/2) = a_{i+1} - \frac{1}{2}\frac{\partial a_{i+1}}{\partial x}\Delta x\end{aligned}\end{align} \]</div>
<p>And we use 4th order Runge Kutta to solve this ODE:</p>
<div class="math notranslate nohighlight">
\[\frac{dy}{dt} = f(t,y)\]</div>
<div class="math notranslate nohighlight">
\[y_{n+1} = y_n + \frac{1}{6}dt(k_1+2k_2+2k_3+k_4)\]</div>
<div class="math notranslate nohighlight">
\[t_{n+1} = t_n + dt\]</div>
<p>with:</p>
<div class="math notranslate nohighlight">
\[k_1 = f(t_n,y_n)\]</div>
<div class="math notranslate nohighlight">
\[k_2 = f(t_n+\frac{dt}{2}, y_n + dt\frac{k_1}{2})\]</div>
<div class="math notranslate nohighlight">
\[k_3 = f(t_n+\frac{dt}{2}, y_n + dt\frac{k_2}{2})\]</div>
<div class="math notranslate nohighlight">
\[k_4 = f(t_n + dt, y_n + dtk_3)\]</div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Note at least 2nd order Runge Kutta method must be used for this method.</p>
</div>
</section>
<section id="slope-choices">
<h2>Slope choices<a class="headerlink" href="#slope-choices" title="Permalink to this headline"></a></h2>
<p>From the two methods above, we left out the choices of the slope <span class="math notranslate nohighlight">\(\frac{\partial a_i}{\partial x}\)</span>.
We could set <span class="math notranslate nohighlight">\(\frac{\partial a_i}{\partial x = 0}\)</span>, which implies a <em>picewise constant</em> slope. This method does not account for overshoot or undershoots at discontinuity states.</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>If one uses piecewise constant slope for predictor corrector method, it gets back the same upwinding method.</p>
</div>
<p>Using slope limiters will modify the piecewise linear slopes near extrema to prevent overshoots and undershoots. Generally check whether slope of the left and slope on the right have the same sigh, by invoking $a cdot b &gt; 0$. If they are not the same sign, we are an extrema. Therefore limit the slope to force it be 0.</p>
<section id="mindmod-limiter">
<h3>Mindmod Limiter<a class="headerlink" href="#mindmod-limiter" title="Permalink to this headline"></a></h3>
<div class="math notranslate nohighlight">
\[\left. \frac{\partial a}{\partial x} \right|_i = \textrm{minmod}\left( \frac{a_i - a_{i-1}}{\Delta x}, \frac{a_{i+1}-a_i}{\Delta x}\right)\]</div>
<p>where minmod(a,b) is defined as:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\textrm{minmod}(a,b) =
\begin{array}{lll}
a &amp; if &amp; |a| &lt; |b| &amp; \textrm{and} &amp; a \cdot b &gt; 0 \\
b &amp; if &amp; |b| &lt; |a| &amp; \textrm{and} &amp; a \cdot b &gt; 0 \\
0 &amp;&amp; \textrm{otherwise} \\
\end{array}\end{split}\]</div>
</section>
<section id="monotonized-central-difference-limiter-mc-limiter">
<h3>Monotonized central difference Limiter (MC limiter)<a class="headerlink" href="#monotonized-central-difference-limiter-mc-limiter" title="Permalink to this headline"></a></h3>
<p>Define:</p>
<div class="math notranslate nohighlight">
\[\xi = (a_{i+1} - a_i) \cdot (a_i - a_{i-1})\]</div>
<p>Then:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\left. \frac{\partial a}{\partial x}\right|_i =
\begin{array}{ll}
\textrm{min} \left[\frac{\left| a_{i+1}-a_{i-1} \right|}{2\Delta x} , 2\   frac{\left| a_{i+1} - a_i \right|}{\Delta x}, 2 \frac{\left| a_i - a_{i-    1} \right|}{\Delta x} \right] \textrm{sign} (a_{i+1}-a_{i-1}) &amp; \xi &gt; 0 \\
0 &amp; \textrm{otherwise}
\end{array}\end{split}\]</div>
</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="lin_one_d_advection.html" class="btn btn-neutral float-left" title="Linear 1-D Advection" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="one_d_advection_docs.html" class="btn btn-neutral float-right" title="1-D advection in C++" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022, Zhi Chen.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>